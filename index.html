<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="./img/MacGyver_the_Lizard.jpg">
    <title>Magaiba so gentle</title>
    <style>

* {
    padding: 0;
    margin: 0;
}

body{
    background: #584040;
}


.contenedor {
    display: flex;
    align-items: center;
    width: 920px;
    height: 280px;
    margin: 0 auto;
    justify-content:center ;
    
    position: relative;

    background: linear-gradient(#b7d6c7, transparent) #ffe2d1;
    transition: background-color 1s linear;
    overflow: hidden;
}

.mediodia {
    background-color: #ffdcf3;
}

.tarde {
    background-color: #ffadad;
}

.noche {
    background-color: #aca8c7;
}

.magaiba {
    width: 84px;
    height: 84px;

    position: absolute;
    bottom: 22px;
    left: 42px;
    z-index: 2;

    background: url(img/magaiba.png) repeat-x 0px 0px;
    background-size: 336px 84px;
    background-position-x: 0px;

}

.magaiba-corriendo {
    animation: animarMagaiba 0.25s steps(2) infinite;
}
.magaiba-estrellado {
    background-position-x: -252px;
}

.suelo {
    width: 200%;
    height: 42px;

    position: absolute;
    bottom: 0;
    left: 0;

    background: url(img/suelo.png) repeat-x 0px 0px;
    background-size: 50% 42px;

}

.cactus{
    width: 46px;
    height: 96px;

    position: absolute;
    bottom: 16px;
    left: 600px;
    z-index: 1;

    background: url(img/obelisco.png) no-repeat;
}
.cactus2{
    width: 98px;
    height: 66px;

    background: url(img/argband.png) no-repeat;
}

.nube{
    width: 92px;
    height: 26px;

    position: absolute;
    z-index: 0;

    background: url(img/nube.png) no-repeat;
    background-size: 92px 26px;
}

.score{
    width: 100px;
    height: 30px;

    position: absolute;
    top: 5px;
    right: 15px;
    z-index: 10;

    color: #d48871;
    font-family: Verdana;
    font-size: 30px;
    font-weight: bold;
    text-align: right;
}

.game-over{
    display: none;

    position: absolute;
    width: 100%;


    text-align: center;
    color: #7e928b;
    font-size: 30px;
    font-family: Verdana;
    font-weight: 700;
}

footer {
    font-family: Arial, sans-serif; 
    font-size: 18px;
    letter-spacing: 1px; 
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    background-color: #333;
    color: #fff;
    padding: 20px;
        }
        

.info {
    display: flex;
    justify-content: center;
    background-color: #333;
    color: #fff;
    padding: 10px;
        }

@keyframes animarMagaiba{
    from{
        background-position-x: -84px;
    }
    to{
        background-position-x: -252px;
    }
}

.main{
    flex: 1;
    min-height: calc(100vh - 126px);
    display: flex;
    align-items: center;
    
}

a {
    font-size: 16px;
    color: white; 
    text-decoration: none;  
}

a:hover {
    text-decoration: underline;
}

.info a {
    margin: 0 10px;
}


    </style>
</head>
<body>
    <div class="info">
        <a href="https://www.youtube.com/@magaibasogentle" target="_blank" class="hover:text-green-500 flex gap-2 justify-center items-center" data-astro-cid-j7pv25f6="">
          Magaiba Channel
  
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="h-5 w-5" fill="currentColor" viewBox="0 0 50 50">
            <path d="M 44.898438 14.5 C 44.5 12.300781 42.601563 10.699219 40.398438 10.199219 C 37.101563 9.5 31 9 24.398438 9 C 17.800781 9 11.601563 9.5 8.300781 10.199219 C 6.101563 10.699219 4.199219 12.199219 3.800781 14.5 C 3.398438 17 3 20.5 3 25 C 3 29.5 3.398438 33 3.898438 35.5 C 4.300781 37.699219 6.199219 39.300781 8.398438 39.800781 C 11.898438 40.5 17.898438 41 24.5 41 C 31.101563 41 37.101563 40.5 40.601563 39.800781 C 42.800781 39.300781 44.699219 37.800781 45.101563 35.5 C 45.5 33 46 29.398438 46.101563 25 C 45.898438 20.5 45.398438 17 44.898438 14.5 Z M 19 32 L 19 18 L 31.199219 25 Z"></path>
          </svg>
        </a>
  
        <a href="https://t.me/magaibasogentle" target="_blank" class="hover:text-green-500 flex gap-2 justify-center items-center" data-astro-cid-j7pv25f6="">
          Telegram Channel
  
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="h-6 w-6" fill="currentColor" height="50" viewBox="0 0 50 50">
            <path d="M 25 8 C 15.611 8 8 15.611 8 25 C 8 34.389 15.611 42 25 42 C 34.389 42 42 34.389 42 25 C 42 15.611 34.389 8 25 8 z M 25 9 C 33.837 9 41 16.163 41 25 C 41 33.837 33.837 41 25 41 C 16.163 41 9 33.837 9 25 C 9 16.163 16.163 9 25 9 z M 31.986328 18.306641 C 31.593984 18.261266 31.102031 18.367656 30.550781 18.566406 C 29.543781 18.929406 16.672687 24.394938 15.929688 24.710938 C 15.224688 25.010938 14.557641 25.337547 14.556641 25.810547 C 14.556641 26.142547 14.754828 26.329438 15.298828 26.523438 C 15.864828 26.725437 17.290813 27.158625 18.132812 27.390625 C 18.943813 27.614625 19.867766 27.418656 20.384766 27.097656 C 20.932766 26.756656 27.262797 22.521391 27.716797 22.150391 C 28.170797 21.779391 28.531156 22.255953 28.160156 22.626953 C 27.788156 22.998953 23.444094 27.214828 22.871094 27.798828 C 22.175094 28.507828 22.669719 29.243109 23.136719 29.537109 C 23.669719 29.873109 27.502078 32.442469 28.080078 32.855469 C 28.658078 33.267469 29.243297 33.455078 29.779297 33.455078 C 30.315297 33.455078 30.596281 32.748688 30.863281 31.929688 C 31.176281 30.970687 32.642266 21.407438 32.822266 19.523438 C 32.876266 18.953437 32.69675 18.573297 32.34375 18.404297 C 32.237 18.353047 32.117109 18.321766 31.986328 18.306641 z"></path>
          </svg>
        </a>
        <a href="https://x.com/magaibasogentle" target="_blank" class="hover:text-green-500 flex gap-2 justify-center items-center" data-astro-cid-j7pv25f6="">
          Follow on
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24" data-astro-cid-j7pv25f6="">
            <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-astro-cid-j7pv25f6=""></path></svg></a>
        <a href="https://discord.gg/K4NAjhQs" target="_blank" class="hover:text-green-500 flex gap-2 justify-center items-center" data-astro-cid-j7pv25f6="">
          Discord
          <svg xmlns="http://www.w3.org/2000/svg"width="20" height="20" fill="currentColor" class="h-5 w-5" viewBox="0 0 50 50">
            <path d="M 18.90625 7 C 18.90625 7 12.539063 7.4375 8.375 10.78125 C 8.355469 10.789063 8.332031 10.800781 8.3125 10.8125 C 7.589844 11.480469 7.046875 12.515625 6.375 14 C 5.703125 15.484375 4.992188 17.394531 4.34375 19.53125 C 3.050781 23.808594 2 29.058594 2 34 C 1.996094 34.175781 2.039063 34.347656 2.125 34.5 C 3.585938 37.066406 6.273438 38.617188 8.78125 39.59375 C 11.289063 40.570313 13.605469 40.960938 14.78125 41 C 15.113281 41.011719 15.429688 40.859375 15.625 40.59375 L 18.0625 37.21875 C 20.027344 37.683594 22.332031 38 25 38 C 27.667969 38 29.972656 37.683594 31.9375 37.21875 L 34.375 40.59375 C 34.570313 40.859375 34.886719 41.011719 35.21875 41 C 36.394531 40.960938 38.710938 40.570313 41.21875 39.59375 C 43.726563 38.617188 46.414063 37.066406 47.875 34.5 C 47.960938 34.347656 48.003906 34.175781 48 34 C 48 29.058594 46.949219 23.808594 45.65625 19.53125 C 45.007813 17.394531 44.296875 15.484375 43.625 14 C 42.953125 12.515625 42.410156 11.480469 41.6875 10.8125 C 41.667969 10.800781 41.644531 10.789063 41.625 10.78125 C 37.460938 7.4375 31.09375 7 31.09375 7 C 31.019531 6.992188 30.949219 6.992188 30.875 7 C 30.527344 7.046875 30.234375 7.273438 30.09375 7.59375 C 30.09375 7.59375 29.753906 8.339844 29.53125 9.40625 C 27.582031 9.09375 25.941406 9 25 9 C 24.058594 9 22.417969 9.09375 20.46875 9.40625 C 20.246094 8.339844 19.90625 7.59375 19.90625 7.59375 C 19.734375 7.203125 19.332031 6.964844 18.90625 7 Z M 18.28125 9.15625 C 18.355469 9.359375 18.40625 9.550781 18.46875 9.78125 C 16.214844 10.304688 13.746094 11.160156 11.4375 12.59375 C 11.074219 12.746094 10.835938 13.097656 10.824219 13.492188 C 10.816406 13.882813 11.039063 14.246094 11.390625 14.417969 C 11.746094 14.585938 12.167969 14.535156 12.46875 14.28125 C 17.101563 11.410156 22.996094 11 25 11 C 27.003906 11 32.898438 11.410156 37.53125 14.28125 C 37.832031 14.535156 38.253906 14.585938 38.609375 14.417969 C 38.960938 14.246094 39.183594 13.882813 39.175781 13.492188 C 39.164063 13.097656 38.925781 12.746094 38.5625 12.59375 C 36.253906 11.160156 33.785156 10.304688 31.53125 9.78125 C 31.59375 9.550781 31.644531 9.359375 31.71875 9.15625 C 32.859375 9.296875 37.292969 9.894531 40.3125 12.28125 C 40.507813 12.460938 41.1875 13.460938 41.8125 14.84375 C 42.4375 16.226563 43.09375 18.027344 43.71875 20.09375 C 44.9375 24.125 45.921875 29.097656 45.96875 33.65625 C 44.832031 35.496094 42.699219 36.863281 40.5 37.71875 C 38.5 38.496094 36.632813 38.84375 35.65625 38.9375 L 33.96875 36.65625 C 34.828125 36.378906 35.601563 36.078125 36.28125 35.78125 C 38.804688 34.671875 40.15625 33.5 40.15625 33.5 C 40.570313 33.128906 40.605469 32.492188 40.234375 32.078125 C 39.863281 31.664063 39.226563 31.628906 38.8125 32 C 38.8125 32 37.765625 32.957031 35.46875 33.96875 C 34.625 34.339844 33.601563 34.707031 32.4375 35.03125 C 32.167969 35 31.898438 35.078125 31.6875 35.25 C 29.824219 35.703125 27.609375 36 25 36 C 22.371094 36 20.152344 35.675781 18.28125 35.21875 C 18.070313 35.078125 17.8125 35.019531 17.5625 35.0625 C 16.394531 34.738281 15.378906 34.339844 14.53125 33.96875 C 12.234375 32.957031 11.1875 32 11.1875 32 C 10.960938 31.789063 10.648438 31.699219 10.34375 31.75 C 9.957031 31.808594 9.636719 32.085938 9.53125 32.464844 C 9.421875 32.839844 9.546875 33.246094 9.84375 33.5 C 9.84375 33.5 11.195313 34.671875 13.71875 35.78125 C 14.398438 36.078125 15.171875 36.378906 16.03125 36.65625 L 14.34375 38.9375 C 13.367188 38.84375 11.5 38.496094 9.5 37.71875 C 7.300781 36.863281 5.167969 35.496094 4.03125 33.65625 C 4.078125 29.097656 5.0625 24.125 6.28125 20.09375 C 6.90625 18.027344 7.5625 16.226563 8.1875 14.84375 C 8.8125 13.460938 9.492188 12.460938 9.6875 12.28125 C 12.707031 9.894531 17.140625 9.296875 18.28125 9.15625 Z M 18.5 21 C 15.949219 21 14 23.316406 14 26 C 14 28.683594 15.949219 31 18.5 31 C 21.050781 31 23 28.683594 23 26 C 23 23.316406 21.050781 21 18.5 21 Z M 31.5 21 C 28.949219 21 27 23.316406 27 26 C 27 28.683594 28.949219 31 31.5 31 C 34.050781 31 36 28.683594 36 26 C 36 23.316406 34.050781 21 31.5 21 Z M 18.5 23 C 19.816406 23 21 24.265625 21 26 C 21 27.734375 19.816406 29 18.5 29 C 17.183594 29 16 27.734375 16 26 C 16 24.265625 17.183594 23 18.5 23 Z M 31.5 23 C 32.816406 23 34 24.265625 34 26 C 34 27.734375 32.816406 29 31.5 29 C 30.183594 29 29 27.734375 29 26 C 29 24.265625 30.183594 23 31.5 23 Z"></path></svg></a>
      </div>
    <div class="main">
        
        <div class="contenedor">

            <div class="suelo"></div>
            
            <div class="magaiba magaiba-corriendo"></div>
    
            <div class="score">0</div>
    
        </div>
    
        <div class="game-over">Not gentle</div>
    </div>
    <footer>
        <p>
            Created by: Censored
        </p>
        <p> Design: Lozax Pixel, Ro</p>
    </footer>


<script>

//****** GAME LOOP ********//

var time = new Date();
var deltaTime = 0;

if(document.readyState === "complete" || document.readyState === "interactive"){
    setTimeout(Init, 1);
}else{
    document.addEventListener("DOMContentLoaded", Init); 
}

function Init() {
    time = new Date();
    Start();
    Loop();
}

function Loop() {
    deltaTime = (new Date() - time) / 1000;
    time = new Date();
    Update();
    requestAnimationFrame(Loop);
}

//****** GAME LOGIC ********//

var sueloY = 22;
var velY = 0;
var impulso = 900;
var gravedad = 2500;

var magaibaPosX = 42;
var magaibaPosY = sueloY; 

var sueloX = 0;
var velEscenario = 1280/3;
var gameVel = 1;
var score = 0;

var parado = false;
var saltando = false;

var tiempoHastaObstaculo = 2;
var tiempoObstaculoMin = 0.7;
var tiempoObstaculoMax = 1.8;
var obstaculoPosY = 16;
var obstaculos = [];

var tiempoHastaNube = 0.5;
var tiempoNubeMin = 0.7;
var tiempoNubeMax = 2.7;
var maxNubeY = 270;
var minNubeY = 100;
var nubes = [];
var velNube = 0.5;

var contenedor;
var magaiba;
var textoScore;
var suelo;
var gameOver;

function Start() {
    gameOver = document.querySelector(".game-over");
    suelo = document.querySelector(".suelo");
    contenedor = document.querySelector(".contenedor");
    textoScore = document.querySelector(".score");
    magaiba = document.querySelector(".magaiba");
    document.addEventListener("keydown", HandleKeyDown);
    backgroundMusic.play();
}

function Update() {
    if(parado) return;
    
    Movermagaibasaurio();
    MoverSuelo();
    DecidirCrearObstaculos();
    DecidirCrearNubes();
    MoverObstaculos();
    MoverNubes();
    DetectarColision();

    velY -= gravedad * deltaTime;
}

function HandleKeyDown(ev){
    if(ev.keyCode == 32){
        Saltar();
    }
}

document.addEventListener("keydown", function(event) {
    if (event.keyCode === 32 && parado) {
        resetGame();
    }
});

function resetGame() {
    for (var i = obstaculos.length - 1; i >= 0; i--) {
        obstaculos[i].parentNode.removeChild(obstaculos[i]);
    }
    obstaculos = [];

    for (var i = nubes.length - 1; i >= 0; i--) {
        nubes[i].parentNode.removeChild(nubes[i]);
    }
    nubes = [];

    sueloX = 0;
    velEscenario = 1280/3;
    gameVel = 1;
    score = 0;
    parado = false;
    saltando = false;
    tiempoHastaObstaculo = 2;
    tiempoHastaNube = 0.5;
    textoScore.innerText = score;
    gameOver.style.display = "none";
    contenedor.classList.remove("mediodia", "tarde", "noche");
    magaiba.classList.remove("magaiba-estrellado");
    magaiba.style.bottom = sueloY + "px";
    magaiba.classList.add("magaiba-corriendo");
    suelo.style.animationDuration = (3/gameVel)+"s";
}
document.addEventListener('DOMContentLoaded', function() {
    var targetElement = document.querySelector('.main');
    function scrollToMainContent() {
        targetElement.scrollIntoView({ behavior: 'smooth' });
    }

    document.addEventListener('touchstart', function(event) {
        if (!event.target.closest('a') && !event.target.closest('button')) {
            scrollToMainContent();
            Saltar()
            if ( parado) {
        resetGame();
    }
        }
        
    });
});

function Saltar(){
    if(magaibaPosY === sueloY){
        saltando = true;
        velY = impulso;
        magaiba.classList.remove("magaiba-corriendo");
    }
}

function Movermagaibasaurio() {
    magaibaPosY += velY * deltaTime;
    if(magaibaPosY < sueloY){
        
        TocarSuelo();
    }
    magaiba.style.bottom = magaibaPosY+"px";
}

function TocarSuelo() {
    magaibaPosY = sueloY;
    velY = 0;
    if(saltando){
        magaiba.classList.add("magaiba-corriendo");
    }
    saltando = false;
}

function MoverSuelo() {
    sueloX += CalcularDesplazamiento();
    suelo.style.left = -(sueloX % contenedor.clientWidth) + "px";
}

function CalcularDesplazamiento() {
    return velEscenario * deltaTime * gameVel;
}

function Estrellarse() {
    magaiba.classList.remove("magaiba-corriendo");
    magaiba.classList.add("magaiba-estrellado");
    parado = true;
}

function DecidirCrearObstaculos() {
    tiempoHastaObstaculo -= deltaTime;
    if(tiempoHastaObstaculo <= 0) {
        CrearObstaculo();
    }
}

function DecidirCrearNubes() {
    tiempoHastaNube -= deltaTime;
    if(tiempoHastaNube <= 0) {
        CrearNube();
    }
}

function CrearObstaculo() {
    var obstaculo = document.createElement("div");
    contenedor.appendChild(obstaculo);
    obstaculo.classList.add("cactus");
    if(Math.random() > 0.5) obstaculo.classList.add("cactus2");
    obstaculo.posX = contenedor.clientWidth;
    obstaculo.style.left = contenedor.clientWidth+"px";

    obstaculos.push(obstaculo);
    tiempoHastaObstaculo = tiempoObstaculoMin + Math.random() * (tiempoObstaculoMax-tiempoObstaculoMin) / gameVel;
}

function CrearNube() {
    var nube = document.createElement("div");
    contenedor.appendChild(nube);
    nube.classList.add("nube");
    nube.posX = contenedor.clientWidth;
    nube.style.left = contenedor.clientWidth+"px";
    nube.style.bottom = minNubeY + Math.random() * (maxNubeY-minNubeY)+"px";
    
    nubes.push(nube);
    tiempoHastaNube = tiempoNubeMin + Math.random() * (tiempoNubeMax-tiempoNubeMin) / gameVel;
}

function MoverObstaculos() {
    for (var i = obstaculos.length - 1; i >= 0; i--) {
        if(obstaculos[i].posX < -obstaculos[i].clientWidth) {
            obstaculos[i].parentNode.removeChild(obstaculos[i]);
            obstaculos.splice(i, 1);
            GanarPuntos();
        }else{
            obstaculos[i].posX -= CalcularDesplazamiento();
            obstaculos[i].style.left = obstaculos[i].posX+"px";
        }
    }
}

function MoverNubes() {
    for (var i = nubes.length - 1; i >= 0; i--) {
        if(nubes[i].posX < -nubes[i].clientWidth) {
            nubes[i].parentNode.removeChild(nubes[i]);
            nubes.splice(i, 1);
        }else{
            nubes[i].posX -= CalcularDesplazamiento() * velNube;
            nubes[i].style.left = nubes[i].posX+"px";
        }
    }
}

function GanarPuntos() {
    score++;
    textoScore.innerText = score;
    if(score == 5){
        gameVel = 1.5;
        contenedor.classList.add("mediodia");
    }else if(score == 10) {
        gameVel = 2;
        contenedor.classList.add("tarde");
    } else if(score == 20) {
        gameVel = 3;
        contenedor.classList.add("noche");
    }
    suelo.style.animationDuration = (3/gameVel)+"s";
}

function GameOver() {
    Estrellarse();
    gameOver.style.display = "block";
}

function DetectarColision() {
    for (var i = 0; i < obstaculos.length; i++) {
        if(obstaculos[i].posX > magaibaPosX + magaiba.clientWidth) {

            break; 
        }else{
            if(IsCollision(magaiba, obstaculos[i], 10, 30, 15, 20)) {
                GameOver();
            }
        }
    }
}

function IsCollision(a, b, paddingTop, paddingRight, paddingBottom, paddingLeft) {
    var aRect = a.getBoundingClientRect();
    var bRect = b.getBoundingClientRect();

    return !(
        ((aRect.top + aRect.height - paddingBottom) < (bRect.top)) ||
        (aRect.top + paddingTop > (bRect.top + bRect.height)) ||
        ((aRect.left + aRect.width - paddingRight) < bRect.left) ||
        (aRect.left + paddingLeft > (bRect.left + bRect.width))
    );
}


</script>
<audio id="backgroundMusic" loop autoplay>
    <source src="./audio/Magaiba_mesita.mp3" type="audio/mpeg">
    Tu navegador no soporta la etiqueta de audio.
</audio>

</body>

</html>